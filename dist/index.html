<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content=" Neighborhood Map - Washington DC ">
    <meta name="author" content=" Youness Assassi ">
	<title>Neighborhood Map by Youness Assassi</title>
	<link rel="stylesheet" type="text/css" href="css/lib/bootstrap.min.css">
	<style>
html{height:100%}body{margin:0}.back{height:100%;width:100%;padding:0}.top{height:auto;position:absolute;top:30px;right:20px;left:20px}.bottom{height:200px;position:absolute;bottom:0;right:0;left:0;background-color:#f0f8ff;overflow:auto}.close-data-window{padding:4px}#map{height:600px;width:100%}.search-results{padding-left:0;padding-right:39px}.list-group{overflow-y:auto;overflow-x:hidden;max-height:130px}#status{color:red}btn-link{background-color:#fff}
</style>
  	<script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6EYUtm0s4m4c9VxmScProhIrzexk2YhU">
    </script>
</head>
<body>
	<!-- Map container -->
	<div class="container back">
		<div class="row">
			<div class="col-xs-12">
				<div id="map" class="container-map"></div>
				<div data-bind="map:map" ></div>
			</div>
		</div>
	</div>
	<!-- Search section container -->
	<div class="container top">
		<!-- Search bar -->
		<div class="row">
			<div class="input-group col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3">
				<input type="text" class="search-query form-control" placeholder="Search" id="search-box" data-bind="value: searchTerm, valueUpdate: 'afterkeydown', event: {'keyup': filterResults}">
				<span class="input-group-btn">
					<button class="btn btn-primary" type="button" data-bind="click: search, enable: searchTerm">
						<span class="glyphicon glyphicon-search"></span>
					</button>
				</span>
			</div>
		</div>
		<!-- Search results -->
		<div class="row">
			<div class="col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3 search-results">
				<div data-bind="foreach: places" class="list-group">
					<a href="#" class="list-group-item" data-bind="click: function() { $parent.changeDataWindowVisibility(true); $root.removeSelections(); $data.activateMarker(); $root.updateSearchTerm()}, visible: showListItem, css: {active: $data.isSelected}">
						<span data-bind="text: $data.name"></span>
					</a>
			    </div>
			</div>
		</div>
	</div>
	<!-- Data section container -->
	<div class="container bottom" data-bind="visible: isDataWindowOpen">
		<div class="row">
			<button class="close" type="button" data-bind="click: changeDataWindowVisibility(false)">
				<span class="glyphicon glyphicon-remove close-data-window"></span>
			</button>
		</div>
		<div class="row">
			<div class="col-md-12">
				<div id="status" data-bind="text: statusMessage">

				</div>
			</div>
		</div>
		<div class="row">
			<!-- Wikipedia section -->
			<div class="col-xs-12 col-sm-6">
				<h5 id="wikipedia-header">Relevant Wikipedia Links</h5>
				<ul id="wikipediaArticles">
				</ul>
			</div>
			<!-- New York Times section -->
			<div class="col-xs-12 col-sm-6">
				<h5 id="nyTimes-header">Relevant New York Times Links</h5>
				<ul id="nytimesArticles">
				</ul>
			</div>
		</div>
	</div>
	<script src="js/lib/jquery-1.11.2.min.js"></script>
	<script src="js/lib/bootstrap.min.js"></script>
	<script src="js/lib/knockout-3.2.0.min.js"></script>
	<script>
"use strict";var infowindow=null,selectFromListMessage="Please select one location",noMatchFoundMessage="No match was found.  Please try a different term",noWikiResources="Failed to retrieve Wikipedia resources",noNYTArticles="Failed to retrieve New York Times articles",$wikiElem=$("#wikipediaArticles"),$nytElem=$("#nytimesArticles"),initialPlaces=[{name:"Washington Monument",address:"2 15th St NW Washington, DC 20007",latitude:"38.8895",longitude:"-77.0352"},{name:"The White House",address:"1600 Pennsylvania Ave NW Washington, DC 20500",latitude:"38.8977",longitude:"-77.0366"},{name:"United States Capitol",address:"200 D St SW Washington, DC 20024",latitude:"38.8897",longitude:"-77.0089"},{name:"Smithsonian National Air and Space Museum",address:"600 Independence Ave SW Washington, DC 20560",latitude:"38.88816",longitude:"-77.019868"},{name:"National Museum of the American Indian",address:"4th St & Independence Ave SW Washington, DC 20560",latitude:"38.888207",longitude:"-77.016522"},{name:"Smithsonian National Museum of Natural History",address:"10th St. & Constitution Ave. NW Washington, DC 20560",latitude:"38.8910964",longitude:"-77.0249119"}],Place=function(e){this.name=ko.observable(e.name),this.address=ko.observable(e.address),this.latitude=ko.observable(e.latitude),this.longitude=ko.observable(e.longitude),this.marker="",this.showListItem=ko.observable(!0),this.isSelected=ko.observable(!1),this.nytArticles=ko.observableArray([]),this.wikipediaArticles=ko.observableArray([]),this.changeSelectionStatus=function(e){this.isSelected(e)},this.changePlaceMarkerVisibility=function(e){this.marker.setVisible(e)},this.bouncePlaceMarker=function(){this.marker.setAnimation(google.maps.Animation.BOUNCE);var e=this;setTimeout(function(){e.marker.setAnimation(null)},1400)},this.activateMarker=function(){this.isSelected(!0),this.bouncePlaceMarker(),this.getNewYorkTimesData(),this.getWikipediaData(),this.marker.map.setCenter(this.marker.getPosition()),infowindow.setContent(this.name()),infowindow.open(this.marker.map,this.marker)},this.getNewYorkTimesData=function(){var e="e1d4a459b4b1f9239fd618037ddf86df:11:61795967",a="http://api.nytimes.com/svc/search/v2/articlesearch.json?q="+this.name()+"&sort=newest&api-key="+e,t=setTimeout(function(){$nytElem.text(noNYTArticles)},4e3);$.ajax({url:a,dataType:"json",success:function(e){for(var a=e.response.docs,i=a.length<=3?a.length:3,n=0;i>n;n++){var s=a[n];$nytElem.append('<li class="article"><a href="'+s.web_url+'">'+s.headline.main+"</a><p>"+s.snippet+"</p></li>")}clearTimeout(t)},error:function(){$nytElem.text(noNYTArticles)}})},this.getWikipediaData=function(){var e="http://en.wikipedia.org/w/api.php?action=opensearch&search="+this.name()+"&format=json&callback=wikiCallback",a=setTimeout(function(){$wikiElem.text(noWikiResources)},4e3);$.ajax({url:e,dataType:"jsonp",success:function(e){for(var t=e[1],i=t.length<=3?t.length:3,n=null,s=0;i>s;s++){n=t[s];var o="http://en.wikipedia.org/wiki/"+n;$wikiElem.append('<li><a href="'+o+'">'+n+"</a></li>")}clearTimeout(a)},error:function(){$wikiElem.text(noWikiResources)}})}},ViewModel=function(){var e=this;e.places=ko.observableArray([]),e.isDataWindowOpen=ko.observable(!1),e.searchTerm=ko.observable(),e.statusMessage=ko.observable(),initialPlaces.forEach(function(a){e.places.push(new Place(a))});var a=function(e,a){return e.name()<a.name()?-1:e.name()>a.name()?1:0};e.places().sort(a),e.changeDataWindowVisibility=function(a){$wikiElem.empty(),$nytElem.empty(),e.statusMessage(""),e.isDataWindowOpen(a)},e.removeSelections=function(){for(var a in e.places())e.places()[a].changeSelectionStatus(!1)},e.updateSearchTerm=function(){for(var a in e.places())e.places()[a].isSelected()&&e.searchTerm(e.places()[a].name())},e.search=function(){var a=e.searchTerm().toLowerCase(),t=null,i=0;switch($.each(e.places(),function(e,n){var s=n.name().toLowerCase();-1!==s.indexOf(a)&&(i++,t=e)}),i){case 0:e.changeDataWindowVisibility(!0),e.statusMessage(noMatchFoundMessage);break;case 1:e.removeSelections(),e.places()[t].activateMarker(),e.updateSearchTerm(),e.changeDataWindowVisibility(!0);break;default:e.changeDataWindowVisibility(!0),e.statusMessage(selectFromListMessage)}},e.filterResults=function(){var a=e.searchTerm().toLowerCase();infowindow.close(),$.each(e.places(),function(e,t){var i=t.name().toLowerCase();-1===i.indexOf(a)?(t.changePlaceMarkerVisibility(!1),t.showListItem(!1)):(t.changePlaceMarkerVisibility(!0),t.showListItem(!0))})},ko.bindingHandlers.map={init:function(){var a=new google.maps.LatLngBounds,t={mapTypeId:"roadmap",disableDefaultUI:!0};infowindow=new google.maps.InfoWindow,e.map=new google.maps.Map($("#map")[0],t),e.map.setTilt(45);var i=null;for(var n in e.places()){var s=new google.maps.LatLng(e.places()[n].latitude(),e.places()[n].longitude());a.extend(s),i=new google.maps.Marker({position:s,map:e.map,title:e.places()[n].name()}),i.set("placeLocation",e.places()[n]),google.maps.event.addListener(i,"click",function(){var a=this.get("placeLocation");e.removeSelections(),a.activateMarker(),e.changeDataWindowVisibility(!0),e.updateSearchTerm()}),e.places()[n].marker=i}e.map.fitBounds(a);var o=google.maps.event.addListener(e.map,"bounds_changed",function(){this.setZoom(13),google.maps.event.removeListener(o)})}}},viewModel=new ViewModel;$(document).ready(function(){ko.applyBindings(viewModel)});
</script>
</body>
</html>